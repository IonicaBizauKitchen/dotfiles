{"mode":"editor","version":1,"windowDimensions":{"x":0,"y":22,"width":1440,"height":874},"syntax":{"deserializer":"Syntax","grammarOverridesByPath":{}},"project":{"path":"/Users/zeke/code/hero/harp-buildpack","buffers":[{"text":"#!/usr/bin/env bash\n\nset -e            # fail fast\nset -o pipefail   # don't ignore exit codes when piping output\n# set -x          # enable debugging\n\n# Configuration\nbuild_dir=$1\ncache_dir=$2\nenv_dir=$3\nbp_dir=$(cd $(dirname $0); cd ..; pwd)\n\n# Load some convenience functions like status(), echo(), and indent()\nsource $bp_dir/bin/common.sh\n\n# Make config vars available to the build\nif [ -d \"$env_dir\" ]; then\n  status \"Exporting config vars to environment\"\n  export_env_dir $env_dir\nfi\n\n# Fetch the latest stable node version from semver.io\nnode_version=$(curl --silent --get https://semver.io/node/stable)\n\n# Download node from Heroku's S3 mirror of nodejs.org/dist\nstatus \"Downloading and installing node $node_version\"\nnode_url=\"http://s3pository.heroku.com/node/v$node_version/node-v$node_version-linux-x64.tar.gz\"\ncurl $node_url -s -o - | tar xzf - -C $build_dir\n\n# Move node (and npm) into ./vendor and make them executable\nmkdir -p $build_dir/vendor\nmv $build_dir/node-v$node_version-linux-x64 $build_dir/vendor/node\nchmod +x $build_dir/vendor/node/bin/*\nPATH=$PATH:$build_dir/vendor/node/bin\n\n# Run subsequent node/npm commands from the build path\ncd $build_dir\n\n# Create a node_modules directory if one doesn't already exist\nmkdir -p $build_dir/node_modules\n\nif [ -f \"$build_dir/package.json\" ]; then\n  # Found package.json; installing any npm dependencies\n  status \"Installing npm dependencies\"\n  npm install --production 2>&1 | indent\nfi\n\n# Copy harp dependency to node_modules\ncp -r $bp_dir/node_modules/harp $build_dir/node_modules/\n\n# Create a Procfile\nstatus \"Creating a harp server Procfile\"\necho \"web: ./node_modules/harp/bin/harp server ${HARP_ROOT:-.} -p \\$PORT\" > $build_dir/Procfile\n\n# Update the PATH\n# status \"Building runtime environment\"\nmkdir -p $build_dir/.profile.d\necho \"export PATH=\\\"\\$HOME/vendor/node/bin:\\$HOME/bin:\\$HOME/node_modules/.bin:\\$PATH\\\";export NODE_ENV=${NODE_ENV:production}\" > $build_dir/.profile.d/nodejs.sh\n","markers":{"markers":{"1":{"id":1,"range":[[2,0],[19,2]],"tailed":true,"reversed":true,"valid":true,"invalidate":"never","persistent":true,"properties":{"type":"selection","editorId":18,"goalBufferRange":null},"deserializer":"Marker"}},"deserializer":"MarkerManager"},"history":{"undoStack":[],"redoStack":[],"deserializer":"History"},"filePath":"/Users/zeke/code/hero/harp-buildpack/bin/compile","modifiedWhenLastPersisted":false,"digestWhenLastPersisted":"f96c036e0e9e4050cf2b6b723f8b4b4a87b53d32","deserializer":"TextBuffer"}],"deserializer":"Project"},"workspace":{"paneContainer":{"root":{"items":[{"id":18,"softTabs":true,"displayBuffer":{"id":19,"softWrap":false,"editorWidthInChars":121,"scrollTop":0,"scrollLeft":0,"tokenizedBuffer":{"bufferPath":"/Users/zeke/code/hero/harp-buildpack/bin/compile","tabLength":2,"deserializer":"TokenizedBuffer"},"deserializer":"DisplayBuffer"},"deserializer":"Editor"}],"activeItemUri":"/Users/zeke/code/hero/harp-buildpack/bin/compile","focused":true,"active":true,"deserializer":"Pane"},"deserializer":"PaneContainer"},"fullScreen":false,"deserializer":"Workspace"},"packageStates":{"fuzzy-finder":{"/Users/zeke/code/hero/harp-buildpack/bin/compile":1399496569265},"keybinding-resolver":{"attached":false},"metrics":{"sessionLength":1879857},"tree-view":{"directoryExpansionStates":{"bin":{}},"selectedPath":"/Users/zeke/code/hero/harp-buildpack/bin/compile","hasFocus":false,"attached":true,"scrollLeft":0,"scrollTop":0,"width":200},"find-and-replace":{"viewState":{"findHistory":["jq"],"replaceHistory":[],"modelState":{"useRegex":false,"inCurrentSelection":false,"caseSensitive":false}}}}}